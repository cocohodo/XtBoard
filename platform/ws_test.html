<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì‹¤ì‹œê°„ ì‹œì„¸ í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸</title>
  <style>
    body {
      font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;
      padding: 20px;
    }
    input, button {
      margin: 5px;
      padding: 5px;
    }
    #log {
      white-space: pre-wrap;
      background: #000;
      color: #0f0;
      padding: 10px;
      height: 400px;
      overflow-y: scroll;
      font-family: Consolas, monospace;
    }
  </style>
</head>
<body>
  <h2>ì‹¤ì‹œê°„ ì¢…ëª© ì‹œì„¸ êµ¬ë…</h2>

  <label>trcode: <input type="text" id="trcode" value="RKXS3"></label>
  <label>key (ì¢…ëª©ì½”ë“œ): <input type="text" id="key" value="005930"></label>
  <button onclick="sendAdvise()">ğŸ“¡ ì‹¤ì‹œê°„ ìš”ì²­ (advise)</button>
  <button onclick="sendUnadvise()">ğŸ›‘ ì‹¤ì‹œê°„ í•´ì œ (unadvise)</button>

  <h3>ì‹œì„¸ ìˆ˜ì‹  ë¡œê·¸</h3>
  <div id="log"></div>

  <script>
    const ws = new WebSocket("ws://211.240.28.240:30245/ws/");
    const log = document.getElementById("log");

    ws.onopen = () => logMessage("[WebSocket ì—°ê²°ë¨]");
    ws.onclose = () => logMessage("[WebSocket ì—°ê²° ì¢…ë£Œ]");
    ws.onerror = err => logMessage("[WebSocket ì˜¤ë¥˜ ë°œìƒ]");

    ws.onmessage = event => {
      logMessage(event.data);
    };

    function logMessage(msg) {
      log.textContent += msg + "\n";
      log.scrollTop = log.scrollHeight;
    }

    function sendAdvise() {
      const tr = document.getElementById("trcode").value.trim();
      const key = document.getElementById("key").value.trim();
      if (tr && key) {
        const msg = JSON.stringify({ action: "advise", trcode: tr, key: key });
        ws.send(msg);
        logMessage("[send advise] " + msg);
      }
    }

    function sendUnadvise() {
      const tr = document.getElementById("trcode").value.trim();
      const key = document.getElementById("key").value.trim();
      if (tr && key) {
        const msg = JSON.stringify({ action: "unadvise", trcode: tr, key: key });
        ws.send(msg);
        logMessage("[send unadvise] " + msg);
      }
    }
  </script>
</body>
</html>
